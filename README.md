# ğŸ“ Raspberry Pi Intrusion Detection System (IDS)

As part of my work in CNIT 17600 (Information Technology Architectures), I developed a fully functional IDS on a Raspberry Pi to detect early-stage reconnaissance trafficâ€”such as ICMP pings and TCP SYN scansâ€”commonly used by attackers to map networks.

---

## ğŸ” What It Does

| Feature                            | Description                                                                 |
|------------------------------------|-----------------------------------------------------------------------------|
| ğŸ“¡ Packet Sniffing                | Uses Scapy to capture network packets in real time                         |
| ğŸ›¡ï¸ Threat Detection               | Detects ICMP Echo Requests and TCP SYN packets (reconnaissance attempts)   |
| ğŸ“ Logging                        | Alerts are written to both the terminal and a local log file               |
| âš™ï¸ Protocol Support              | Supports ICMP, TCP (SYN flags)                                             |
| ğŸ§ª Validation                     | Tested using tshark, nmap, ping, and hping3                                |

---

## ğŸ“Š Architecture Diagram (Rendered with Mermaid)

```mermaid
flowchart TD
    A[Attacker<br>nmap/ping/hping3] --> B[Tailscale VPN]
    B --> C[Raspberry Pi IDS]
    C --> D[Scapy Sniffer<br>AF_PACKET Layer]
    C --> E[Real-time Alert Console]
    C --> F[ids_alerts.log<br>Ping/SYN logs]
```

---

## ğŸ§ª Tech Stack

- **Language**: Python 3
- **Libraries**: `scapy`, `datetime`, `os`
- **Tools Used**: `tshark`, `nmap`, `ping`, `PowerShell`, `hping3`
- **Hardware**: Raspberry Pi 4
- **Interface**: `tailscale0` (VPN-based interface)

---

## ğŸ’¡ Threat Intelligence Motivation

> ğŸ“ˆ Inspired by IBMâ€™s X-Force Threat Intelligence Index (2022), which found that **40% of cyberattacks begin with reconnaissance**. This project focuses on **detecting before exploiting**.

---

## ğŸš€ Getting Started

### ğŸ§° Prerequisites

- Raspberry Pi with Python 3 installed
- Install `scapy`:
  ```bash
  pip install scapy
  ```
- Tailscale VPN (or another network interface)
- `tshark` (optional, for validation)

### ğŸ”§ Run the IDS

```bash
sudo python3 pi_ids.py
```

Youâ€™ll start seeing real-time alerts like:

```
[2025-04-28 12:28:01] Ping detected from 100.114.6.22
[2025-04-28 12:28:06] SYN packet from 192.168.0.5:49672 to 192.168.0.1:22
```

Log file: `~/ids_alerts.log`

---

## ğŸ§  Key Concepts Learned

- Raw socket programming & AF_PACKET access via Scapy
- Packet structure analysis (ICMP, TCP)
- Filtering with Berkeley Packet Filter (BPF) syntax
- Real-time detection loop with flushable log writes
- Tshark capture validation and Nmap simulation testing

---

## ğŸ§± Use Cases

- ğŸ§ª Student SOC Labs
- ğŸ  Home Network Monitoring
- ğŸ“š Classroom Demonstrations
- ğŸ§± Lightweight edge security deployments

---

## ğŸ§¬ Example Detection Snippet

```python
if pkt.haslayer(ICMP):
    if pkt[ICMP].type == 8:
        print(f"Ping detected from {pkt[IP].src}")

elif pkt.haslayer(TCP):
    if pkt[TCP].flags & 0x02:
        print(f"SYN packet from {pkt[IP].src} to {pkt[IP].dst}")
```

---

## ğŸš§ Future Work

- âœ… MVP complete
- â˜ï¸ AWS CloudWatch log streaming (planned)
- ğŸ“¬ Email/Slack integration for critical alerts
- ğŸ§  ML-based anomaly detection (long-term roadmap)

---

## ğŸ“ File Structure

```text
â”œâ”€â”€ pi_ids.py              # Core Python IDS script
â”œâ”€â”€ ids_alerts.log         # Log of alerts generated by detection
â”œâ”€â”€ README.md              # Project documentation
â”œâ”€â”€ requirements.txt       # Python dependencies
â””â”€â”€ .gitignore             # Ignore log files and Python cache
```

---

## ğŸ“œ License

MIT License
